<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Emacs Golang å¼€å‘ç¯å¢ƒé…ç½® | </title>
  <meta name="description" content="ğŸ¶">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Emacs Golang å¼€å‘ç¯å¢ƒé…ç½®" />
<meta property="og:description" content="Emacs Golang å¼€å‘ç¯å¢ƒé…ç½®" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://404cn.github.io/post/setup-golang-develop-env-on-emacs/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-08-13T00:12:03+08:00" />
<meta property="article:modified_time" content="2021-08-13T00:12:03+08:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Emacs Golang å¼€å‘ç¯å¢ƒé…ç½®"/>
<meta name="twitter:description" content="Emacs Golang å¼€å‘ç¯å¢ƒé…ç½®"/>

  
  
    
  
  
  <link rel="stylesheet" href="https://404cn.github.io/css/style-classic.css">
  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://404cn.github.io/images/favicon.ico" />

  
  
  
  
  
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-204916222-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

    <header id="header">
  <a href="https://404cn.github.io/">
  
    <div id="logo" style="background-image: url(https://404cn.github.io/images/logo.png)"></div>
  
  <div id="title">
    <h1></h1>
  </div>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#"><i class="fas fa-bars fa-2x"></i></a>
      </li>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/post">Writings</a></li>
      
        <li><a href="/tags">Tags</a></li>
      
        <li><a href="/about">About</a></li>
      
    </ul>
  </div>
</header>



    
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <div class="content" itemprop="articleBody">
  
    
<p>
ä½¿ç”¨ Emacs å¼€å‘ Golang ä¸€æ®µæ—¶é—´æ—¶é—´äº†ï¼Œä»Šå¤©å°†ç›¸å…³é…ç½®å’Œè¸©è¿‡çš„å‘æ€»ç»“åˆ†äº«å‡ºæ¥ï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»çš„å¹¶ä¸æ˜¯ä»é›¶å¼€å§‹çš„é…ç½®ï¼Œä¸»è¦éƒ½æ˜¯ä¸ Golang å¼€å‘åŠŸèƒ½ç›¸å…³çš„é…ç½®ï¼Œé»˜è®¤è®¤ä¸ºä½ å·²ç»äº†è§£å¦‚ä½•åœ¨ Emacs æŸ¥çœ‹ä¸€äº›å†…ç½®çš„å‡½æ•°æ–‡æ¡£ï¼Œç»‘å®šå¿«æ·é”®ç­‰åŸºæœ¬æ“ä½œï¼Œä¸€äº›åŸºç¡€çš„ Emacs åŠŸèƒ½å¯ä»¥å‚è€ƒæ¢¦æ¢¦çš„ <a href="https://github.com/condy0919/emacs-newbie/blob/master/introduction-to-builtin-modes.md">Emacs builtin modes åŠŸèƒ½ä»‹ç»</a>ã€‚</p>
<p>
åœ¨ä½¿ç”¨ä»»ä½• ç¼–è¾‘å™¨/IDE å¼€å‘æ—¶ï¼Œæœ€æ ¸å¿ƒçš„éœ€æ±‚æ— éä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li>
<p>æ‹¬å·çš„è‡ªåŠ¨åŒ¹é…</p>
</li>
<li>
<p>ä»£ç çš„è‡ªåŠ¨è¡¥å…¨</p>
</li>
<li>
<p>æŸ¥æ‰¾å®šä¹‰ã€å¼•ç”¨</p>
</li>
<li>
<p>é™æ€æ£€æŸ¥</p>
</li>
<li>
<p>åœ¨é¡¹ç›®ä¸­æ¨¡ç³ŠæŸ¥æ‰¾ï¼ˆæ–‡ä»¶/å­—ç¬¦ä¸²ï¼‰</p>
</li>
</ul>
<div id="outline-container-headline-1" class="outline-3">
<h3 id="headline-1">
å¼€å¯ Emacs è‡ªå¸¦çš„æ‹¬å·åŒ¹é…
</h3>
<div id="outline-text-headline-1" class="outline-text-3">
<p>Emacs è‡ªå¸¦çš„ <code class="verbatim">electric-pair-mode</code> å·²ç»è¶³å¤Ÿå¥½ç”¨ï¼Œåªä¸è¿‡é»˜è®¤æ²¡æœ‰å¼€å¯ã€‚</p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">  (setq electric-pair-inhibit-predicate <span style="color:#e6db74">&#39;electric-pair-conservative-inhibit</span>)
  (add-hook <span style="color:#e6db74">&#39;prog-mode-hook</span> <span style="color:#a6e22e">#&#39;</span>electric-pair-mode)</code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-2" class="outline-3">
<h3 id="headline-2">
å®‰è£… straight.el
</h3>
<div id="outline-text-headline-2" class="outline-text-3">
<p>åœ¨è¿›è¡Œä¸‹ä¸€æ­¥é…ç½®ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå®‰è£… <a href="https://github.com/raxod502/straight.el">straight.el</a> ï¼Œå› ä¸ºæˆ‘ä»¬è¦ç”¨å®ƒæ¥å®‰è£…å…¶ä»–çš„ç¬¬ä¸‰æ–¹åŒ…ã€‚</p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(setq straight-check-for-modifications <span style="color:#f92672">&#39;</span>(check-on-save find-when-checking))
(setq straight-vc-git-default-clone-depth <span style="color:#ae81ff">1</span>)

(setq straight-disable-native-compile
      (when (<span style="color:#a6e22e">fboundp</span> <span style="color:#e6db74">&#39;native-comp-available-p</span>)
	(not (native-comp-available-p))))

(defvar bootstrap-version)
(let ((bootstrap-file
       (<span style="color:#a6e22e">expand-file-name</span> <span style="color:#e6db74">&#34;straight/repos/straight.el/bootstrap.el&#34;</span> user-emacs-directory))
      (bootstrap-version <span style="color:#ae81ff">5</span>))
  (unless (<span style="color:#a6e22e">file-exists-p</span> bootstrap-file)
    (with-current-buffer
        (url-retrieve-synchronously
         <span style="color:#e6db74">&#34;https://raw.githubusercontent.com/raxod502/straight.el/develop/install.el&#34;</span>
         <span style="color:#e6db74">&#39;silent</span> <span style="color:#e6db74">&#39;inhibit-cookies</span>)
      (<span style="color:#a6e22e">goto-char</span> (<span style="color:#a6e22e">point-max</span>))
      (eval-print-last-sexp)))
  (<span style="color:#a6e22e">load</span> bootstrap-file <span style="color:#66d9ef">nil</span> <span style="color:#e6db74">&#39;nomessage</span>))</code></pre></div>
</div>
<p>straight.el åœ¨å®‰è£…å…¶ä»–åŒ…æ—¶éœ€è¦è®¿é—® githubï¼Œå¦‚æœä½ çš„ç½‘ç»œä¸å¤Ÿ <code class="verbatim">ç»¿è‰²</code> å’³å’³â€¦</p>
<p>
å¯ä»¥å°†å®‰è£…æ—¶çš„ <code class="verbatim">github.com</code> æ›¿æ¢ä¸º <code class="verbatim">github.com.cnpmjs.org</code> ã€‚</p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(defun +set-github-mirror (oldfunc <span style="color:#66d9ef">&amp;rest</span> args)
  (let ((url (<span style="color:#a6e22e">apply</span> oldfunc args)))
    (replace-regexp-in-string (rx (group <span style="color:#e6db74">&#34;github.com&#34;</span>))
                              <span style="color:#e6db74">&#34;github.com.cnpmjs.org&#34;</span> url <span style="color:#66d9ef">nil</span> <span style="color:#66d9ef">nil</span> <span style="color:#ae81ff">1</span>)))
(advice-add <span style="color:#e6db74">&#39;straight-vc-git--encode-url</span> :around <span style="color:#a6e22e">#&#39;</span>+set-github-mirror)</code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-3" class="outline-3">
<h3 id="headline-3">
è®¾ç½® major-mode
</h3>
<div id="outline-text-headline-3" class="outline-text-3">
<p>å®‰è£… <a href="https://github.com/dominikh/go-mode.el">go-mode.el</a> ï¼Œå…¶ä¸ºæˆ‘ä»¬åœ¨è¿›è¡Œ Golang å¼€å‘æ—¶æä¾›äº†ç›¸å½“å¤šçš„å¸¸ç”¨åŠŸèƒ½ã€‚</p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">  (straight-use-package <span style="color:#e6db74">&#39;go-mode</span>)</code></pre></div>
</div>
<p>è®¾ç½®ç¼©è¿›ã€‚</p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">  (setq-default tab-width <span style="color:#ae81ff">4</span>
                indent-tabs-mode <span style="color:#66d9ef">nil</span>)</code></pre></div>
</div>
<p>ä½¿ç”¨ <code class="verbatim">goimports</code> ä»£æ›¿ <code class="verbatim">gofmt</code> åœ¨æ–‡ä»¶ä¿å­˜åè‡ªåŠ¨æ ¼å¼åŒ–æˆ‘ä»¬çš„ä»£ç </p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">  (setq gofmt-command <span style="color:#e6db74">&#34;goimports&#34;</span>)
  (add-hook <span style="color:#e6db74">&#39;before-save-hook</span> <span style="color:#a6e22e">#&#39;</span>gofmt-before-save)</code></pre></div>
</div>
<p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ MacOS ç³»ç»Ÿï¼Œé‚£ä¹ˆéœ€è¦ä½¿ç”¨ <a href="https://github.com/purcell/exec-path-from-shell">exec-path-from-shell</a> è®© Emacs è¯»å–ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ï¼Œä¸ç„¶ Emacs å¯èƒ½æ‰¾ä¸åˆ°ä½ å®‰è£…çš„ go</p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">  (when (<span style="color:#a6e22e">eq</span> system-type <span style="color:#e6db74">&#39;darwin</span>)
    (straight-use-package <span style="color:#e6db74">&#39;exec-path-from-shell</span>)
    (setq exec-path-from-shell-arguments <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;-l&#34;</span>))
    (add-hook <span style="color:#e6db74">&#39;after-init-hook</span> <span style="color:#a6e22e">#&#39;</span>exec-path-from-shell-initialize)
    (with-eval-after-load <span style="color:#e6db74">&#34;go-mode&#34;</span>
      (with-eval-after-load <span style="color:#e6db74">&#34;exec-path-from-shell&#34;</span>
        (exec-path-from-shell-copy-envs <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;GOPATH&#34;</span> <span style="color:#e6db74">&#34;GO111MODULE&#34;</span> <span style="color:#e6db74">&#34;GOPROXY&#34;</span>)))))</code></pre></div>
</div>
<p>go-mode åœ¨æ ¼å¼åŒ–ä»£ç æ—¶å¦‚æœå‘ç°é”™è¯¯ä¼šå¼¹å‡ºä¸€ä¸ª bufferï¼Œè¿™ä¼šæ‰“ä¹±æˆ‘ä»¬çš„çª—å£å¸ƒå±€ï¼Œå…¶å®æˆ‘ä»¬åªéœ€è¦ç®€å•çš„è®¾ç½®ä¸‹è‡ªå¸¦çš„ <code class="verbatim">flymake-mode</code> å°±å¯ä»¥æ–¹ä¾¿çš„åœ¨é”™è¯¯ä¹‹é—´è·³è½¬è€Œä¸æ˜¯é€šè¿‡ä¸€ä¸ªå•ç‹¬çš„ buffer æŸ¥çœ‹ã€‚</p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">  (add-hook <span style="color:#e6db74">&#39;prog-mode-hook</span> <span style="color:#a6e22e">#&#39;</span>flymake-mode)
  (with-eval-after-load <span style="color:#e6db74">&#34;flymake&#34;</span>
    (<span style="color:#a6e22e">define-key</span> flymake-mode-map (kbd <span style="color:#e6db74">&#34;C-c C-b&#34;</span>) <span style="color:#e6db74">&#39;flymake-show-diagnostics-buffer</span>)
    (<span style="color:#a6e22e">define-key</span> flymake-mode-map (kbd <span style="color:#e6db74">&#34;M-n&#34;</span>) <span style="color:#e6db74">&#39;flymake-goto-next-error</span>)
    (<span style="color:#a6e22e">define-key</span> flymake-mode-map (kbd <span style="color:#e6db74">&#34;M-p&#34;</span>) <span style="color:#e6db74">&#39;flymake-goto-prev-error</span>))</code></pre></div>
</div>
<p>è¿™æ ·å°±å¯ä»¥ä½¿ç”¨ <code class="verbatim">M-n</code> ï¼Œ <code class="verbatim">M-p</code> åœ¨é”™è¯¯ä¹‹é—´ç§»åŠ¨ï¼Œç„¶åæŠŠ go-mode è‡ªåŠ¨å¼¹å‡ºçš„è¿™ä¸ª buffer å…³æ‰ã€‚</p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">  (setq gofmt-show-errors <span style="color:#66d9ef">nil</span>)</code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-4" class="outline-3">
<h3 id="headline-4">
ä»£ç è¡¥å…¨ã€è·³è½¬
</h3>
<div id="outline-text-headline-4" class="outline-text-3">
<p>å®‰è£… <a href="http://company-mode.github.io/">company-mode</a> ï¼Œåœ¨è¡¥å…¨æ—¶å¯ä»¥ä½¿ç”¨ <code class="verbatim">C-p</code> <code class="verbatim">C-n</code> æˆ–è€… <code class="verbatim">TAB</code> è¿›è¡Œé€‰æ‹©ï¼Œå›è½¦å®Œæˆè¡¥å…¨ã€‚</p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">  (straight-use-package <span style="color:#e6db74">&#39;company</span>)
  (add-hook <span style="color:#e6db74">&#39;prog-mode-hook</span> <span style="color:#a6e22e">#&#39;</span>company-mode)
  (setq company-tooltip-limit <span style="color:#ae81ff">10</span>
        company-tooltip-align-annotations <span style="color:#66d9ef">t</span>
        company-tooltip-width-grow-only <span style="color:#66d9ef">t</span>
        company-abort-manual-when-too-short <span style="color:#66d9ef">t</span>
        company-require-match <span style="color:#66d9ef">nil</span>
        company-backends <span style="color:#f92672">&#39;</span>(company-capf)
        company-tooltip-margin <span style="color:#ae81ff">0</span>)
  (with-eval-after-load <span style="color:#e6db74">&#34;company&#34;</span>
    (<span style="color:#a6e22e">define-key</span> company-active-map [tab] <span style="color:#e6db74">&#39;company-complete-common-or-cycle</span>)
    (<span style="color:#a6e22e">define-key</span> company-active-map (kbd <span style="color:#e6db74">&#34;TAB&#34;</span>) <span style="color:#e6db74">&#39;company-complete-common-or-cycle</span>)
    (<span style="color:#a6e22e">define-key</span> company-active-map (kbd <span style="color:#e6db74">&#34;C-p&#34;</span>) <span style="color:#a6e22e">#&#39;</span>company-select-previous)
    (<span style="color:#a6e22e">define-key</span> company-active-map (kbd <span style="color:#e6db74">&#34;C-n&#34;</span>) <span style="color:#a6e22e">#&#39;</span>company-select-next))</code></pre></div>
</div>
<p>å®‰è£… <a href="https://github.com/joaotavora/eglot">eglot</a> ï¼Œä¸€ä¸ª Emacs ä¸­è½»é‡çº§çš„ LSP å®¢æˆ·ç«¯ï¼Œåœ¨ go-mode ä¸­å¯ç”¨ã€‚</p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">  (straight-use-package <span style="color:#e6db74">&#39;eglot</span>)
  (add-hook <span style="color:#e6db74">&#39;go-mode-hook</span> <span style="color:#a6e22e">#&#39;</span>eglot-ensure)
  (setq eglot-ignored-server-capabilites <span style="color:#f92672">&#39;</span>(:documentHighlightProvider)
        read-process-output-max (<span style="color:#a6e22e">*</span> <span style="color:#ae81ff">1024</span> <span style="color:#ae81ff">1024</span>))</code></pre></div>
</div>
<p>eglot ä½¿ç”¨ Emacs å†…ç½®çš„ project.el ç®¡ç†é¡¹ç›®ï¼Œä»¥ .git ç›®å½•ä½œä¸ºé¡¹ç›®çš„æ ¹ç›®å½•ï¼Œå¦‚æœä½ çš„é¡¹ç›®åŒ…å«ä¸€äº›å­é¡¹ç›®ï¼Œä¾‹å¦‚ï¼š</p>
<pre class="example">
â”œâ”€â”€ .git
â”œâ”€â”€ project1
â”‚Â Â  â”œâ”€â”€ go.mod
â”‚Â Â  â””â”€â”€ main.go
â”œâ”€â”€ project2
â”‚Â Â  â”œâ”€â”€ go.mod
â”‚Â Â  â””â”€â”€ main.go
â””â”€â”€ project3
    â”œâ”€â”€ go.mod
    â””â”€â”€ main.go
</pre>
<p>å¦‚æœä½ ä¸æƒ³è®© project1 ä¸­çš„ä»£ç å‡ºç°åœ¨ project2 çš„è¡¥å…¨ä¸­ï¼Œæˆ–è€…åœ¨ project2 ä¸­æŸ¥æ‰¾å®šä¹‰æ—¶ä¸æƒ³è¦ project1 ä¸­çš„å®šä¹‰å‡ºç°åœ¨ä½ çš„é€‰æ‹©åˆ—è¡¨ä¸­æ—¶ï¼Œåˆ™æ¨èä½¿ç”¨ <code class="verbatim">go.mod</code> æ‰€åœ¨çš„ç›®å½•ä¸ºé¡¹ç›®çš„æ ¹ç›®å½•ï¼Œè§£å†³ä¸åŒé¡¹ç›®é—´çš„ä»£ç è¡¥å…¨ä¸è·³è½¬å½±å“ã€‚</p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">  (with-eval-after-load <span style="color:#e6db74">&#34;go-mode&#34;</span>
    (with-eval-after-load <span style="color:#e6db74">&#34;project&#34;</span>
      (defun project-find-go-module (dir)
        (when-let ((root (locate-dominating-file dir <span style="color:#e6db74">&#34;go.mod&#34;</span>)))
          (<span style="color:#a6e22e">cons</span> <span style="color:#e6db74">&#39;go-module</span> root)))
      (cl-defmethod project-root ((project (head go-module)))
        (<span style="color:#a6e22e">cdr</span> project))
      (add-hook <span style="color:#e6db74">&#39;project-find-functions</span> <span style="color:#a6e22e">#&#39;</span>project-find-go-module)))</code></pre></div>
</div>
<p>eglot é»˜è®¤ä¼šä½¿ç”¨ eldoc æ˜¾ç¤ºå‡½æ•°ç­‰æ–‡æ¡£ï¼Œä½†æ˜¯å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¸æ˜¯æƒ³ç«‹å³æŸ¥çœ‹ï¼Œä¸ºäº†é˜²æ­¢æ–‡æ¡£æ‰°ä¹±è§†çº¿ï¼Œç»™ eldoc è®¾ç½®ä¸ª delay æ—¶é—´ã€‚</p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(setq eldoc-idle-dealy <span style="color:#ae81ff">2</span>)</code></pre></div>
</div>
<p>å¦‚æœä½ æƒ³åœ¨è¡¥å…¨å‡½æ•°æ—¶å¸¦æœ‰å ä½ç¬¦ï¼Œå¯ä»¥å¯¹é¡¹ç›®è¿›è¡Œå•ç‹¬çš„é…ç½®ï¼Œåªéœ€è¦åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ <code class="verbatim">.dir-locals.el</code> ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼Œeglot å°±ä¼šåœ¨åˆå§‹åŒ– gopls ä¹‹åä¿®æ”¹ gopls çš„é…ç½®ï¼Œå½“ç„¶è¿™ä¸ªåŠŸèƒ½ä¾èµ– <a href="https://github.com/joaotavora/yasnippet">yasnippet</a> ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿéœ€è¦å®‰è£…å®ƒã€‚</p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">  (straight-use-package <span style="color:#e6db74">&#39;yasnippet</span>)
  (add-hook <span style="color:#e6db74">&#39;prog-mode-hook</span> <span style="color:#a6e22e">#&#39;</span>yas-minor-mode)</code></pre></div>
</div>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­åˆ›å»º <code class="verbatim">.dir-locals.el</code> ã€‚</p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">  ((go-mode
    <span style="color:#f92672">.</span> ((eglot-workspace-configuration
        <span style="color:#f92672">.</span> ((:gopls <span style="color:#f92672">.</span> (:usePlaceholders <span style="color:#66d9ef">t</span>)))))))</code></pre></div>
</div>
<p>å½“ç„¶ä¹Ÿå¯ä»¥åœ¨ä½ çš„é…ç½®æ–‡ä»¶ä¸­é»˜è®¤å¼€å¯ï¼Œè¿™æ ·å°±ä¸éœ€è¦å¯¹é¡¹ç›®å•ç‹¬è®¾ç½®ã€‚</p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">  (setq-default eglot-workspace-configuration
                <span style="color:#f92672">&#39;</span>((gopls
                   (usePlaceholders <span style="color:#f92672">.</span> <span style="color:#66d9ef">t</span>))))</code></pre></div>
</div>
<p>å¦ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ tip æ˜¯å¦‚æœä½ çš„é¡¹ç›®ä½¿ç”¨äº† <a href="https://golang.org/pkg/go/build/#hdr-Build_Constraints">Build Constraints</a> ï¼Œä¹Ÿå¯ä»¥é’ˆå¯¹é¡¹ç›®å•ç‹¬ä¿®æ”¹ <code class="verbatim">gopls</code> çš„é…ç½®ä½¿ä»£ç çš„è¡¥å…¨ä¸è·³è½¬å®Œç¾çš„å·¥ä½œã€‚</p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">  ((go-mode
    <span style="color:#f92672">.</span> ((eglot-workspace-configuration
        <span style="color:#f92672">.</span> ((:gopls <span style="color:#f92672">.</span> (:buildFlags [<span style="color:#e6db74">&#34;-tags=debug&#34;</span>])))))))</code></pre></div>
</div>
<p>è¿™é‡Œå°±ä¸å†™å‡ºå…¨å±€å¼€å¯çš„ç¤ºä¾‹äº†ï¼Œè€Œä¸”è¿™ä¸ªåŠŸèƒ½ä¸€èˆ¬ä¸éœ€è¦å…¨å±€å¼€å¯ã€‚</p>
</div>
</div>
<div id="outline-container-headline-5" class="outline-3">
<h3 id="headline-5">
æ€»ç»“
</h3>
<div id="outline-text-headline-5" class="outline-text-3">
<p>Emacs å†…ç½®çš„ electric-pair-mode å¸®æˆ‘ä»¬å®ç°äº†æ‹¬å·åŒ¹é…ï¼Œ project.el å¯ä»¥åœ¨é¡¹ç›®ä¸­æŸ¥æ‰¾æ–‡ä»¶ã€å­—ç¬¦ä¸²ç­‰ï¼ˆ <code class="verbatim">project-find-file</code> <code class="verbatim">project-search</code> <code class="verbatim">project-switch-to-buffer</code> ï¼‰ã€‚</p>
<p>
åœ¨å®‰è£…äº† eglotã€company-mode åå®ç°äº†ä»£ç çš„è¡¥å…¨ã€è·³è½¬ç­‰åŠŸèƒ½ï¼ˆ <code class="verbatim">xref-find-definitions</code> <code class="verbatim">xref-find-references</code> ï¼‰ï¼ŒåŒæ—¶ eglot é…åˆå†…ç½®çš„ flymake ä¹Ÿä¸ºæˆ‘ä»¬æä¾›äº†é™æ€æ£€æŸ¥ã€‚</p>
<p>
å½“ç„¶è¿™äº›æ’ä»¶çš„åŠŸèƒ½è¿œä¸åªè¿™äº›ï¼Œä¾‹å¦‚ eglot å¯ä»¥å¸®ä½ é‡å‘½åå‡½æ•°æˆ–å˜é‡ï¼ˆåŒæ—¶ä¿®æ”¹å…¶å¼•ç”¨å¤„çš„åå­—ï¼‰ï¼Œ company-mode ä¸ä»…å¯ä»¥è¡¥å…¨ä»£ç ä¹Ÿå¯ä»¥è¡¥å…¨æ–‡ä»¶è·¯å¾„ã€ä»£ç ç‰‡æ®µï¼Œåœ¨ç¼–å†™ Golang æ—¶éœ€è¦ç”¨åˆ°çš„ä¸€äº›å·¥å…·é“¾æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥é€šè¿‡ elisp ç®¡ç†ä»è€Œè¾¾åˆ°ä¸€ä¸ªå‘½ä»¤è¿›è¡Œå®‰è£…/æ›´æ–°ç­‰ã€‚</p>
<p>
åœ¨ Emacs ä¸­èƒ½é™åˆ¶ä½ çš„åªæœ‰ä½ çš„æƒ³è±¡åŠ›ä¸è¡ŒåŠ¨åŠ›ï¼Œç§ç§å¼ºå¤§æˆ–å®ç”¨çš„åŠŸèƒ½ä¸å¯èƒ½åœ¨ä¸€ç¯‡æ–‡ç« ä¸­å…¨éƒ¨ä»‹ç»ï¼Œå‰©ä¸‹çš„å°±éœ€è¦ä½ è‡ªå·±å‘ç°æˆ–è€…æ ¹æ®è‡ªèº«ç‰¹å®šéœ€æ±‚è¿›è¡Œæ‰©å±•äº†ã€‚</p>
</div>
</div>

  
  </div>
</article>


    <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2021   
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/post">Writings</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
</html>
